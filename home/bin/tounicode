#!/bin/bash

# Convert colon-enclosed keywords to corresponding Unicode symbols in text
# files or stdin.

declare -A unicode

unicode[elementof]=âˆˆ
unicode[times]=Ã—
unicode[notelementof]=âˆ‰
unicode[infinity]=âˆž
unicode[leftarrow]=â†
unicode[rightarrow]=â†’
unicode[graduation]=ðŸŽ“
unicode[briefcase]=ðŸ’¼
unicode[office]=ðŸ¢
unicode[mail]=ðŸ“«
unicode[multiply]=Ã—
unicode[divide]=Ã·
unicode[notequal]=â‰ 
unicode[link]=ðŸ”—

tounicode() {
	local in=/dev/stdin
	local out=/dev/stdout
	local file=$1
	if [[ -n $file ]]; then
		in=$file
		out=$(mktemp)
	fi
	IFS=$'\n'
	while read -r line; do
		for k in "${!unicode[@]}"; do
			line=${line//:$k:/${unicode[$k]}}
		done
		echo "$line" >>"$out"
	done <"$in"
	if [[ -n $file ]]; then
		cp "$out" "$file"
		rm "$out"
	fi
}

tounicode "$@"
